---
- name: meraki deployment
  connection: local
  hosts: localhost
  vars:
    auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30616434316334343139336264383964613432353062336438373039373432346635663863373533
          3463386363376134336333353063613863353131383663300a343439353937666565633933613235
          62376432336166383337633965623562323131303038336566333431333530363035636362393363
          3135343932343032340a623034613961613836616536613637393835643137353137633139316532
          32666537666434343866383330653839376630313632616239663631306336346461393561316239
          3731383463646266376561643863613362363134613633373361
    org_name: "{{ org }}"
    switch_serial: "{{ switch_serial }}"

  tasks:
   - name: Query information about all switchports on a switch
     meraki_switchport:
       auth_key: "{{ auth_key }}"
       serial: "{{ switch_serial }}"
       state: query
     delegate_to: localhost
     register: switchinfo

   - debug: var=switchinfo
