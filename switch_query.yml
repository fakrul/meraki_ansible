---
- name: meraki deployment
  connection: local
  hosts: localhost
  vars:
    auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34626264376464636163376464653537303935343661343565653566333530323736333164663730
          3139346330383335666663393738663139643665313132380a386166653734356365633538616330
          38336262373363623962653537326665653935343465356333323832313861323563373337353939
          6165303237323562620a343334653033623939316265363065363432303231363831303931376135
          34643431613639656330393532353065386536623461623064323734333635326533613165653166
          3138323932646334353538326536393538656136383838613739
    org_name: "{{ org }}"
    switch_serial: "{{ switch_serial }}"

  tasks:
   - name: Query information about all switchports on a switch
     meraki_switchport:
       auth_key: "{{ auth_key }}"
       serial: "{{ switch_serial }}"
       state: query
     delegate_to: localhost
     register: switchinfo

   - debug: var=switchinfo
